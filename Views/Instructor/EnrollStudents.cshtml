@model StudentViewModel
@{
    ViewBag.Title = "Enroll Students";
}

<h2 class="mb-4">Add Students</h2>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>Success!</strong> @TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong>Error!</strong> @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="alert alert-info">@ViewBag.Message</div>

@if (ViewBag.Students != null && ((IEnumerable<dynamic>)ViewBag.Students).Any())
{
    <h5>Your students</h5>
    <table class="table table-sm">
        <thead>
            <tr>
                <th>Name</th>
                <th>Grade</th>
                <th>Enrollment Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var s in ViewBag.Students)
            {
                <tr>
                    <td>@s.FirstName @s.LastName</td>
                    <td>@s.Grade</td>
                    <td>@s.EnrollmentDate.ToShortDateString()</td>
                    <td>
                        <a href="@Url.Action("StudentProfile", "Instructor", new { id = s.Id })" class="btn btn-sm btn-outline-primary">Profile</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="alert alert-secondary">No students assigned to you yet. Ask admin to create student accounts or enroll existing students from a course page.</div>
}

@section Scripts {
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <script>
        function togglePassword(inputId, btn) {
            const input = document.getElementById(inputId);
            const icon = btn.querySelector('i');
            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            } else {
                input.type = "password";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            }
        }
    </script>
    <style>
        .password-group .input-group {
            position: relative;
        }
        .password-toggle {
            border: none;
            background: transparent;
            color: #6c757d;
            font-size: 1.2rem;
            padding: 0 12px;
            cursor: pointer;
            transition: color 0.2s;
        }
        .password-toggle:focus {
            outline: none;
            box-shadow: none;
        }
        .password-toggle:hover {
            color: #007bff;
        }
        .input-group .form-control {
            border-right: 0;
        }
        .input-group .password-toggle {
            border-left: 0;
        }
    </style>
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }
}